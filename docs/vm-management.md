- [虚拟机管理](#虚拟机管理)
  - [虚拟机列表](#虚拟机列表)
  - [创建虚拟机](#创建虚拟机)
    - [基本信息](#基本信息)
    - [计算资源](#计算资源)
    - [存储](#存储)
    - [网络](#网络)
    - [登录设置](#登录设置)
  - [编辑虚拟机](#编辑虚拟机)
    - [磁盘](#磁盘)
    - [网络](#网络-1)
    - [快照](#快照)
      - [从快照中恢复](#从快照中恢复)
    - [克隆](#克隆)

# 虚拟机管理

通过虚拟机管理，您可以方便地创建、查看、配置和维护虚拟机，以满足不同业务需求。

## 虚拟机列表

虚拟机列表用于展示当前系统中所有已创建的虚拟机，并提供直观的管理视图。您可以在该页面快速查看虚拟机的名称、状态、操作系统、IP 地址、CPU/内存使用情况和主机等关键信息。

前往 `虚拟资源` > `虚拟机` 页面。

![虚拟机管理-虚拟机列表](./images/虚拟机管理-虚拟机列表.png)

## 创建虚拟机

您可以根据业务需求选择合适的操作系统、计算资源、存储和网络配置。

前往 `虚拟资源` > `虚拟机`，进入 `虚拟机列表` 页面，选择 `创建虚拟机`。

### 基本信息

虚拟机在创建时会从指定的系统镜像启动，并将其写入系统盘。如何创建镜像，请参阅[镜像页面](./volume.md#镜像)。

![基本信息](./images/基本信息.png)

![基本信息-镜像列表](./images/基本信息-镜像列表.png)

![基本信息-选择镜像](./images/基本信息-选择镜像.png)

### 计算资源

CPU 建议使用整数，若填写小数将自动向上取整。支持 CPU 和内存的热加载。如需配置 CPU 或内存超配，请在虚拟机创建完成后使用编辑功能进行调整。

![计算资源](./images/计算资源.png)

### 存储

虚拟机可以配置一个或多个磁盘，用于存放操作系统、应用程序数据等。磁盘可以灵活配置，支持动态扩展、挂载和卸载，以满足不同应用场景的存储需求。

系统盘大小需要大于系统镜像大小。如何创建磁盘，请参阅[磁盘页面](./volume.md#磁盘)。

![数据盘列表](./images/数据盘列表.png)

![添加数据盘](./images/添加数据盘.png)

### 网络

可为虚拟机添加多张网卡，每张网卡可以配置不同的网络，支持 Underlay/Overlay 网络共存。

如何创建网络，请参阅[网络页面](./network.md)。

![网络列表](./images/网络列表.png)

![添加网卡](./images/添加网络.png)

### 登录设置

用户名/密码：可以通过用户名和密码登录至虚拟机。

![登录设置](./images/登录设置.png)

## 编辑虚拟机

创建虚拟机后，您可以点击虚拟机进入详情页面，并通过切换选项卡查看虚拟机的基础信息、监控、磁盘、网卡、快照等内容。此外，您还可以对虚拟机进行相关管理操作，如调整资源配置、挂载/卸载磁盘、修改网络设置、创建快照和克隆等，以满足业务需求。

> 编辑完成虚拟机之后，还需要重启虚拟机以使配置更改生效。

![虚拟机详情-总览](./images/虚拟机详情-总览.png)

### 磁盘

点击 `磁盘` 选项卡，添加额外的磁盘。如何创建磁盘，请参阅[磁盘页面](./volume.md#磁盘)。

![编辑虚拟机-磁盘](./images/编辑虚拟机-磁盘.png)

点击右上角 `∙∙∙` 按钮，选择 `添加磁盘`，进入添加磁盘弹窗框。

![编辑虚拟机-添加磁盘](./images/编辑虚拟机-添加磁盘.png)

点击右上角 `∙∙∙` 按钮，选择 `电源` > `重启` 按钮重启虚拟机，以使配置更改生效。

点击右上角 `∙∙∙` 按钮，选择 `打开控制台` 按钮，连接到虚拟机。输入 `lsblk` 命令，查看虚拟机的磁盘信息。

![编辑虚拟机-添加磁盘-虚拟机终端](./images/编辑虚拟机-添加磁盘-虚拟机终端.png)

### 网络

点击 `网络` 选项卡，添加额外的网络。如何创建网络，请参阅[网络页面](./network.md)。

![编辑虚拟机-网络](./images/编辑虚拟机-网络.png)

点击右上角 `∙∙∙` 按钮，选择 `添加网络`。

![编辑虚拟机-添加网络](./images/编辑虚拟机-添加网络.png)

点击右上角 `∙∙∙` 按钮，选择 `电源` > `重启` 按钮重启虚拟机，以使配置更改生效。

点击右上角 `∙∙∙` 按钮，选择 `打开控制台` 按钮，连接到虚拟机。输入 `ip a` 命令，查看虚拟机的网卡信息。

![编辑虚拟机-添加网络-虚拟机终端](./images/编辑虚拟机-添加网络-虚拟机终端.png)

### 快照

快照（Snapshot）用于记录虚拟机在特定时间点的运行状态，包括磁盘数据和内存状态。通过快照，您可以快速恢复虚拟机到某个历史状态，以应对系统升级、配置变更或故障恢复等场景。

点击 `快照` 选项卡，进入虚拟机快照页面。

![编辑虚拟机-创建快照](./images/编辑虚拟机-创建快照.png)

点击右上角 `∙∙∙` 按钮，选择 `创建快照`。

点击右上角 `∙∙∙` 按钮，选择 `打开控制台`，连接到虚拟机，执行 `echo 1 > 1.txt` 往虚拟机中写入数据。

![编辑虚拟机-创建快照-虚拟机控制台-写入数据1](./images/编辑虚拟机-创建快照-虚拟机控制台-写入数据1.png)

点击右上角 `∙∙∙` 按钮，选择 `创建快照`，为写入 `1.txt` 数据之后的虚拟机创建快照。

点击右上角 `∙∙∙` 按钮，选择 `打开控制台`，连接到虚拟机，执行 `echo 2 > 2.txt` 往虚拟机中写入数据。

![编辑虚拟机-创建快照-虚拟机控制台-写入数据2](./images/编辑虚拟机-创建快照-虚拟机控制台-写入数据2.png)

#### 从快照中恢复

从快照中恢复虚拟机是将虚拟机回滚到特定时间点的操作，通常用于恢复到故障前的状态，或者恢复到某个已知的稳定状态。恢复快照后，虚拟机会恢复到该快照创建时的所有配置、数据和运行状态。

点击右上角 `∙∙∙` 按钮，选择 `电源` > `关机` 按钮关闭虚拟机。

选择快照，点击 `从快照中恢复` 按钮，等待虚拟机恢复完成。

![快照-从快照中恢复虚拟机按钮](./images/快照-从快照中恢复虚拟机按钮.png)

![快照-从快照中恢复虚拟机](./images/快照-从快照中恢复虚拟机.png)

点击右上角 `∙∙∙` 按钮，选择 `电源` > `启动`，启动虚拟机。

点击右上角 `∙∙∙` 按钮，选择 `打开控制台`，连接到虚拟机，执行 `ls & cat 1.txt` 查看写入的数据是否正常。

![快照-从快照中恢复虚拟机-虚拟机控制台-查看恢复的数据](./images/快照-从快照中恢复虚拟机-虚拟机控制台-查看恢复的数据.png)

### 克隆

通过克隆虚拟机，您可以轻松创建多个与原始虚拟机配置相同的新虚拟机。克隆的虚拟机将继承原虚拟机的所有配置，包括操作系统、磁盘、网络设置以及登录凭证等。这样，您无需重新配置每个虚拟机的详细信息，能够快速实现大规模环境部署或测试环境的复制。

> 克隆之后的虚拟机会继承原始虚拟机的网络配置，重新分配网卡的 IP 和 MAC 地址。

点击右上角 `∙∙∙` 按钮，选择 `克隆`，输入克隆虚拟机名称，点击 `确定` 按钮。

![克隆-克隆虚拟机](./images/克隆-克隆虚拟机.png)

前往 `任务管理` > `克隆`，进入 `克隆列表` 页面，查看克隆虚拟机的状态。

![克隆-任务管理-克隆列表](./images/克隆-任务管理-克隆列表.png)

前往 `虚拟资源` > `虚拟机`，进入 `虚拟机列表` 页面。点击右上角 `∙∙∙` 按钮，启动克隆的虚拟机，以及 `打开控制台`，连接到虚拟机。

![克隆-虚拟机列表-启动克隆的虚拟机](./images/克隆-虚拟机列表-启动克隆的虚拟机.png)

执行 `ls & cat 1.txt` 查看克隆的虚拟机是否与原始虚拟机写入的数据相同。

![克隆-虚拟机列表-虚拟机控制台](./images/克隆-虚拟机列表-虚拟机控制台.png)
